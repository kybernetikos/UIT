<!DOCTYPE html>
<html>
<head>
    <title>UIT - A Universal Decimal Time</title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link rel="apple-touch-icon" href="images/icon_64.png" />
    <link rel="apple-touch-icon-precomposed" href="images/icon_64.png" />

    <script src="solar/JulianDay.js"></script>
    <script src="solar/Time.js"></script>
    <script src="solar/SolarPosition.js"></script>
    <script src="Clock.js"></script>

    <style>
        * {
            margin: 0px;
            padding: 0px;
        }
        html, body {
            left: 0px;
            right: 0px;
            top: 0px;
            bottom: 0px;
            position: absolute;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <canvas id="display"></canvas>

    <script type="text/javascript">
        var star = new Image();
        star.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACy0lEQVR42s2VXUhTYRjHX5msSNKyTIPIBJWwLgRTsCDSmywjUgwyLIU+tFqtoky6sFRCoyx1assobIiGyVJLMSsdxqYommlLxwKVCEOQpAv3np33+O8J76TEyUZd/HngcPj9nvd5zgcD4NH8XwIxejFGfDof6znBiNYghjUGjwgU2+Ug8fmCJIbOSqL/dJDbBdR9rjJRC2WsGqLvZK5bBQRX0+wn8e0Z8PUp5O6MSbkrTe02Ac39qGLXEVwPjJdCGSqA3HHkmPsEH7Isc+MEHysCvuRjzlYIuT3F4pKAIBoxmCXE4BnMJwtiIBOi/xQUW/k83HYdGLlCyYbozYazKRHOhj2Q6qIhGSIgPQmG9ChQcP1azR9PQMtLoEzPTTQCPz8CM/3Aj16CVwKjOYD1EjCkAUgO6zXgexMwaaRqhLCcA3+4fppX+CQsOiLZkh4qm9PtyjAB7XnU7VWCaYHh3+BMYOAE0JcG9KQAlgNUEyG3xIC6tnPditAl7UDuTPWnJZpETwZBjwO9h4HuJMB8EOjaC3TuBt5FU42EbAwHf+Bn4mXe/i4t2dmWrHK2HtIp5lSCJwPv9wGmOALHAu2RlAiIZoJXrtbxMpVqWU+Rs3F/pPyKwGbqumMn8CYKaIsAWrYAr4PhfLwGvNSLbGDLE9TvKlbexhE8hoDbgNYw4OUmoGkd0OwH8dwX/C4rWZZAqotSSTXbp2CKpq7DSBBCdTN1H0hwH6DBi0RqOIrYlOMWU7kuqA5Nkl/soJmHA+3BkOsDQbOe4ffZjFzjTXAGNDI4qxgcBSzJdUHVBqNo20qL3Egv0Erwe8xA4whw3KYUMoOkYxC1lHoS3GRGlwRc7x/AK1ZJcq0vCGzld1j8wnsc+SyewFanngQ3mEQJWLqgfKWWl7BZXsxyqOO/fjUJqqbkUGYp2qULSr3yCB6y8PoiohBK3j/76Xs0vwCREourrc6evAAAAABJRU5ErkJggg==";

        var canvas = document.getElementById('display');
        var g = canvas.getContext("2d");

        window.onresize = function() {
            canvas.setAttribute("width", document.body.clientWidth);
            canvas.setAttribute("height", document.body.clientHeight);
        };
        window.onresize();

        var clock = new Clock();

        // clock.addEvent("Beer", Time.fromLocalValues(17, 00, 00), null, star);
        // clock.addEvent("Meeting", Time.fromLocalValues(10, 30, 00), Time.fromLocalValues(11, 30, 00));

        navigator.geolocation.getCurrentPosition(function (position) {
            clock.setLocation(position.coords.latitude, position.coords.longitude);
        });

        var mouseDown = false;
        canvas.onmousedown = function(event) {
            mouseDown = true;
            this.onmousemove(event);
        };
        canvas.onmouseup = function() {
            mouseDown = false;
            setTimeout(function() {
                clock.showSelection(false);
            }, 1000);
        };
        canvas.onmousemove = function(event) {
            if (mouseDown) {
                clock.setSelection(event.clientX, event.clientY);
                clock.showSelection(true);
            }
        };

        var localTimeZone = new Date().getTimezoneOffset() / -60;
        var events = [];
        function render() {
            var width = Number(canvas.getAttribute("width"));
            var height = Number(canvas.getAttribute("height"));
            var centerX = width / 2;
            var centerY = height / 2;
            var max = Math.max(width, height);
            var longest = Math.sqrt(max * max * 2);
            var scale = Math.min(width, height);
            g.clearRect(0, 0, width, height);

            clock.render(g, centerX - scale / 2, centerY - scale / 2, scale);

            //g.fillRect(width / 2 - 5, height / 2 - 5, 10, 10);
            // no need to draw every frame.

            setTimeout(animate, 100);
        }

        var reqFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame;
        var animate = reqFrame.bind(null, render, canvas);
        animate();

    </script>
</body>
</html>